# 30-Day Retention & Habit-Loop System

## 1. Retention Objectives (Explicit Success Metrics)

Users achieve **repeat, value-driven usage** over the first 30 days through:

### Metric A: Weekly Return Visits
- **Target:** ≥70% of users return at least once per week  
- **Measurement:** Consecutive weeks active, session count  
- **Trigger:** First return within Day 3, then weekly consistency

### Metric B: Increasing Personalization Accuracy
- **Target:** Recommendation match scores improve 20%+ over 30 days  
- **Measurement:** Completion rates on discovery loop, save-to-view ratio  
- **Trigger:** Automatic refinement after 10+ interactions per loop

### Metric C: Compounding Actions
- **Target:** ≥1 repeated action per loop (saves, portfolio changes, community engagement)  
- **Measurement:** Growth metrics for saves, adjustments, follows  
- **Trigger:** Track weekly deltas

---

## 2. Habit Loops (Three Primary Triggers)

### Loop A: Discovery Loop (Deal Momentum)

**Trigger Condition:**
- User saves a deal
- User views 3+ deals in session
- User dismisses a deal

**Flow:**
1. User saves deal → "Great choice! Here are 3 more like this"
2. Show related deals with match-score explanations
3. Suggest one light action: "Save this one too?" (optional)
4. Reward: "Your deal feed just got smarter"

**Reward Elements:**
- Improved recommendations over time
- Visual progress: "You've saved 5 deals this week"
- Confidence language: "Match accuracy improving"

**Completion:** Loop is "completed" when user acts on related recommendation

**Habit Success Rate:** Target 50%+ completion rate over 30 days

---

### Loop B: Insight Loop (Portfolio Intelligence)

**Trigger Condition:**
- User views analytics or portfolio page
- User views portfolio goals
- 5+ days of consistent activity (periodic check-in)

**Flow:**
1. User views analytics → Surface 1–2 new insights or projections
2. Insight examples:
   - "Based on your goals, you're on track for 12.5% annual return"
   - "2 new deals this week fit your long-term strategy"
   - "Your diversification is strong; consider exploring [sector]"
3. Tie insights directly to real opportunities
4. Invite micro-adjustment: "Adjust time horizon?" (optional field)
5. Reward: "Your strategy is becoming more refined"

**Reward Elements:**
- Clear progress indicators ("Week 2 of your strategy")
- Confidence language: "You're on track"
- Peer comparisons (optional): "Better than 65% of similar investors"

**Completion:** Loop is "completed" when user explores linked deal or adjusts a goal

**Habit Success Rate:** Target 45%+ completion rate over 30 days

---

### Loop C: Social Proof Loop (Community Value)

**Trigger Condition:**
- User joins or views community
- User views discussions
- User follows a person

**Flow:**
1. User joins community → "You're in the right place. Here's what people are discussing"
2. Show high-signal discussions curated by:
   - User's interests
   - Expert-flagged threads
   - Deal-related conversations
3. Recommend people: "Follow [Expert] — they share your interest in [sector]"
4. Low-friction participation: Suggest reactions, bookmarks (no pressure to post)
5. Reward: "You're building your network"

**Reward Elements:**
- Social relevance signals: "5 others saved this discussion"
- Credibility indicators: "Expert verified"
- Engagement feedback: "You've bookmarked 3 discussions"

**Completion:** Loop is "completed" when user follows/reacts or bookmarks content

**Habit Success Rate:** Target 35%+ completion rate over 30 days (lowest friction)

---

## 3. Weekly Rhythm (Non-Intrusive Cadence)

### Weekly Digest (Value-First Summary)

**Frequency:** Default weekly (customizable to 3x/week, biweekly, or none)  
**Default Day:** Monday 9 AM (user's timezone)  
**Content:**

1. **Deals Section** (if discovery loop active)
   - 3–5 new opportunities matching criteria
   - Why they match (sector, size, structure)
   - Call to action: "View Deal"

2. **Insights Section** (if insight loop active)
   - Portfolio projection update
   - New deals for their strategy
   - Suggested micro-adjustment

3. **Community Section** (if social loop active)
   - 1–2 high-signal discussions
   - 1–2 recommended people to follow
   - Conversation snippets

4. **Metrics Summary** (optional)
   - This week's actions (saves, adjustments, follows)
   - Portfolio status
   - Engagement growth

**Rules:**
- No daily mandatory notifications
- Digest frequency adapts based on engagement:
  - High engagement (4+ actions/week) → Weekly
  - Moderate (1–3 actions/week) → Biweekly  
  - Low (<1 action/week) → Biweekly + re-engagement nudge
- User can adjust frequency/content types in settings
- Digest is NOT sent if user is churning (marked inactive)

---

## 4. Intelligent Re-Engagement Logic

### Trigger Conditions

**After 3 Days of Inactivity:**
- Message: "3 deals moved this week — want the highlights?"
- Surface: Email digest + in-app banner
- Tone: Casual, informative, not accusatory

**After 7 Days of Inactivity:**
- Message: "Your portfolio is waiting. Here's your top opportunity this week."
- Surface: Email + push notification
- Tone: Warm, value-focused

**After 14 Days of Inactivity:**
- Message: "We've learned your preferences. Come see smarter matches."
- Surface: Email + in-app modal
- Tone: Confidence-building, highlight improvement

**After 21 Days of Inactivity:**
- Message: "Your community is discussing something relevant..."
- Surface: Email + sidebar notification
- Tone: Social proof, FOMO-light

### Re-Engagement Rules

✅ **Reference prior actions:** "You saved 5 deals — here are 3 more"  
✅ **Value-first:** Focus on what's new/improved, not "we miss you"  
✅ **Avoid guilt:** No language like "Come back" or "Don't forget us"  
✅ **Cooldown logic:** Max 1 re-engagement per 7 days  
✅ **Escalation:** Pause after 3 failed re-engagements (suppress for 30 days)  
✅ **User control:** "Don't send these" button suppresses re-engagement permanently

### Re-Engagement Message Variants

| Inactivity | Message | CTA | Tone |
|---|---|---|---|
| Day 3 | "3 deals moved — want highlights?" | See What's New | Casual |
| Day 7 | "Your portfolio is waiting" | Explore Now | Encouraging |
| Day 14 | "We've learned your preferences" | See Smarter Matches | Confident |
| Day 21 | "Community discussing your interests" | Join Discussion | Social |

---

## 5. Progressive Personalization (Over 30 Days)

### Stage 1: Baseline (Days 1–7)
- Generic recommendations with explanations
- All three habit loops offered
- Learn user's primary interaction pattern

### Stage 2: Learning (Days 8–14)
- Recommendations refine based on 10+ interactions per loop
- Dominant loops emphasized, weaker loops downplayed
- Begin filtering noise

### Stage 3: Refined (Days 15–21)
- Match scores improve 20%+
- Personalized deal feed shows top 5 instead of 10
- Insights become more specific to user's strategy

### Stage 4: Expert (Days 22–30)
- AI model trained on 30+ days of behavior
- Highest-confidence recommendations only
- Predictive insights ("You'll want to see this")

### Rules to Avoid Re-Asking

❌ **Never** re-ask questions already answered  
❌ **Never** reset preferences without explicit consent  
✅ Allow micro-adjustments ("Adjust time horizon?") without heavy setup  
✅ Infer preference evolution from behavior  
✅ Surface deferred setup only when contextually relevant (e.g., "To see portfolio insights, complete this")

---

## 6. Retention State JSON Schema

```json
{
  "user_email": "investor@example.com",
  "retention_status": "early_retention",
  
  "habit_loops": {
    "discovery_loop": {
      "active": true,
      "trigger_count": 8,
      "completions": 4,
      "completion_rate": 50,
      "last_triggered_date": "2026-01-24T14:30:00Z",
      "last_completed_date": "2026-01-24T15:45:00Z"
    },
    "insight_loop": {
      "active": true,
      "trigger_count": 3,
      "completions": 1,
      "completion_rate": 33,
      "last_triggered_date": "2026-01-23T10:00:00Z",
      "last_completed_date": "2026-01-23T10:15:00Z"
    },
    "social_loop": {
      "active": false,
      "trigger_count": 0,
      "completions": 0
    }
  },
  
  "engagement_metrics": {
    "weekly_visits": 4,
    "weekly_actions": 7,
    "consecutive_weeks_active": 1,
    "total_actions_30_days": 12,
    "days_since_last_action": 1,
    "last_activity_date": "2026-01-24T15:45:00Z",
    "current_week_start_date": "2026-01-20"
  },
  
  "personalization_stage": "stage_2_learning",
  
  "digest_preferences": {
    "frequency": "weekly",
    "preferred_day": "monday",
    "preferred_time": "09:00",
    "content_types": ["deals", "insights"],
    "last_digest_sent_date": "2026-01-20T09:00:00Z",
    "digest_open_rate": 100
  },
  
  "reengagement_state": {
    "inactivity_days": 1,
    "last_reengagement_attempt_date": null,
    "reengagement_attempts_count": 0,
    "reengagement_success_count": 0,
    "suppressed_until_date": null,
    "suppression_reason": "none"
  },
  
  "compounding_actions": {
    "saved_deals_count": 5,
    "portfolio_adjustments_count": 1,
    "community_follows_count": 0,
    "community_posts_count": 0,
    "saved_deals_growth_7days": 4,
    "portfolio_changes_7days": 1
  }
}
```

---

## 7. Implementation Flow

```
USER SIGNUP
  ↓
RUN initializeHabitLoops()
  • Determine primary loop based on activation path
  • Activate secondary loops
  ↓
USER INTERACTION (Day 1–30)
  • Save deal → detectHabitTriggers('deal_saved')
  • View analytics → detectHabitTriggers('viewed_analytics')
  • Join community → detectHabitTriggers('community_joined')
  ↓
HABIT LOOP TRIGGERED
  • Show discovery/insight/social prompt
  • Track completion
  • Update RetentionState.habit_loops[].trigger_count
  ↓
WEEKLY SCHEDULE (Monday 9 AM)
  • generateWeeklyDigest()
  • Send personalized summary
  • Track open rate
  ↓
INACTIVITY DETECTED (Day 3+, 7+, 14+, 21+)
  • handleReEngagement()
  • Determine message based on days inactive
  • Send only if not suppressed/at max attempts
  ↓
DAY 30 CHECKPOINT
  • Evaluate retention_status
  • Graduate to "established" if hitting engagement targets
  • Transition to monthly cadence
```

---

## 8. Component Integration

### In Dashboard/Main App

```jsx
<HabitLoopManager onHabitTriggered={(loops) => console.log(loops)}>
  {/* Main app content */}
</HabitLoopManager>
```

### On Deal View Page

```jsx
const { onDealSaved } = useHabitLoops();

const handleSaveDeal = (dealId) => {
  // Save logic
  onDealSaved(dealId); // Triggers discovery loop
};
```

### On Analytics Page

```jsx
const { onAnalyticsViewed } = useHabitLoops();

useEffect(() => {
  onAnalyticsViewed('portfolio_overview'); // Triggers insight loop
}, []);
```

### Weekly Digest Display

```jsx
<WeeklyDigestCard 
  digest={digestData}
  onDismiss={() => markDigestRead()}
  onAction={(item, type) => trackDigestClick(item, type)}
/>
```

---

## 9. Success Metrics & Targets (Day 30)

| Metric | Target | Rationale |
|---|---|---|
| Weekly return visit rate | 70%+ | Habit formation baseline |
| Consecutive weeks active | 4+ | 4-week habit loop |
| Compounding actions per user | 3+ | Multiple loop engagement |
| Digest open rate | 40%+ | Value relevance |
| Re-engagement success rate | 30%+ | Value-first messaging works |
| Recommendation accuracy improvement | 20%+ | Personalization working |
| Retention into Day 30 | 50%+ | Baseline retention |

---

## 10. Tone & Design Philosophy

✅ **Calm, not pushy:** Guidance, not nagging  
✅ **Smart assistant:** Anticipate needs, don't force  
✅ **Confidence-building:** "You're on track," "You're learning"  
✅ **Respect user time:** Digestible summaries, not overwhelming  
✅ **Progress-oriented:** Celebrate small wins  
✅ **Long-term trust:** Value today, not clicks today  

---

## 11. Future Enhancements

- **Predictive loop triggering:** ML model predicts optimal moment for nudge
- **Micro-habits:** Break loops into smaller, daily micro-actions
- **Social gamification:** Leaderboards for community engagement
- **Personalized timing:** Send digest at user's optimal engagement window
- **Loop intensity:** Adjust frequency based on user's preferred pace
- **Churn prediction:** Identify at-risk users before Day 14
- **AI coaching:** Contextual tips ("Try saving a contrarian deal")